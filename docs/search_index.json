[["index.html", "Education Attainment in the US Chapter 1 Introduction", " Education Attainment in the US Yifei Chen and Zujun Peng 2020-12-13 Chapter 1 Introduction "],["data-sources.html", "Chapter 2 Data Sources", " Chapter 2 Data Sources "],["data-cleaning.html", "Chapter 3 Data Cleaning", " Chapter 3 Data Cleaning # Abbreviate character values in the dataset abbreviate &lt;- function(ds, total = FALSE, race = FALSE){ if (!race){ ds$Education[which(ds$Education == &quot;Less.than.high.school.graduate&quot;)] &lt;- &quot;Less Than High School&quot; ds$Education[which(ds$Education == &quot;High.school.graduate..includes.equivalency.&quot;)] &lt;- &quot;High School Graduate&quot; ds$Education[which(ds$Education == &quot;Some.college.or.associate.s.degree&quot;)] &lt;- &quot;Some Colleges&quot; ds$Education[which(ds$Education == &quot;Bachelor.s.degree&quot;)] &lt;- &quot;Bachelor Degree&quot; ds$Education[which(ds$Education == &quot;Graduate.or.professional.degree&quot;)] &lt;- &quot;Advanced Degree&quot; } if (race){ ds$Education[which(ds$Education == &quot;High.school.graduate.or.higher&quot;)] &lt;- &quot;High School or Higher&quot; ds$Education[which(ds$Education == &quot;Bachelor.s.degree.or.higher&quot;)] &lt;- &quot;Bachelor Degree or Higher&quot; ds$Race[which(ds$Race == &quot;White.alone..not.Hispanic.or.Latino&quot; | ds$Race == &quot;White.alone.not.Hispanic.or.Latino&quot;)] &lt;- &quot;White Alone&quot; ds$Race[which(ds$Race == &quot;Hispanic.or.Latino.Origin&quot;)] &lt;- &quot;Hispanic or Latino Origin&quot; ds$Race[which(ds$Race == &quot;Black.alone&quot;)] &lt;- &quot;Black Alone&quot; ds$Race[which(ds$Race == &quot;Asian.alone&quot;)] &lt;- &quot;Asian Alone&quot; ds$Race&lt;- as.factor(ds$Race) ds$Race&lt;-fct_relevel(ds$Race,&quot;White Alone&quot;,&quot;Hispanic or Latino Origin&quot;,&quot;Black Alone&quot;, &quot;Asian Alone&quot;,&quot;Other&quot;) } ds$Education &lt;- as.factor(ds$Education) if(total){ ds$Education &lt;- fct_relevel(ds$Education,&quot;Less Than High School&quot;,&quot;High School Graduate&quot;,&quot;Some Colleges&quot;,&quot;Bachelor Degree&quot;, &quot;Advanced Degree&quot;,&quot;Total&quot;) } if(!total&amp;&amp;!race){ ds$Education&lt;-fct_relevel(ds$Education,&quot;Less Than High School&quot;,&quot;High School Graduate&quot;,&quot;Some Colleges&quot;,&quot;Bachelor Degree&quot;, &quot;Advanced Degree&quot;) } if(race){ ds$Education&lt;-fct_relevel(ds$Education,&quot;Total&quot;,&quot;High School or Higher&quot;,&quot;&gt;= Bachelor Degree or Higher&quot;) } return(ds) } states &lt;- read.csv(&quot;./data/states.csv&quot;, na.strings = &quot;N/A&quot;) #extract columns for education attainment states_education &lt;- states[,1:7] states_education &lt;- states_education %&gt;% pivot_longer(cols =!State ,names_to = &quot;Education&quot;,values_to = &quot;Population&quot;) #extract columns for median earning states_earning &lt;- states[,c(1,8,9,10,11,12,13)] states_earning &lt;- states_earning %&gt;% pivot_longer(cols =!State ,names_to = &quot;Education&quot;,values_to = &quot;Earning&quot;) #combine data states &lt;- cbind(states_education,states_earning[,3]) states &lt;- abbreviate(states,total = TRUE) states ## State Education Population Earning ## 1 Alabama Total 3360058 37217 ## 2 Alabama Less Than High School 433073 22395 ## 3 Alabama High School Graduate 1039241 30845 ## 4 Alabama Some Colleges 1002387 35107 ## 5 Alabama Bachelor Degree 547975 50643 ## 6 Alabama Advanced Degree 337382 60922 ## 7 Alaska Total 484058 47809 ## 8 Alaska Less Than High School 31090 23264 ## 9 Alaska High School Graduate 139156 36522 ## 10 Alaska Some Colleges 167655 47878 ## 11 Alaska Bachelor Degree 89583 53033 ## 12 Alaska Advanced Degree 56574 71947 ## 13 Arizona Total 4944540 39956 ## 14 Arizona Less Than High School 612998 25701 ## 15 Arizona High School Graduate 1170685 31371 ## 16 Arizona Some Colleges 1668699 37016 ## 17 Arizona Bachelor Degree 931038 52077 ## 18 Arizona Advanced Degree 561120 69902 ## 19 Arkansas Total 2036456 35215 ## 20 Arkansas Less Than High School 254993 25695 ## 21 Arkansas High School Graduate 710306 30057 ## 22 Arkansas Some Colleges 595790 31778 ## 23 Arkansas Bachelor Degree 307185 46964 ## 24 Arkansas Advanced Degree 168182 62027 ## 25 California Total 26937872 45095 ## 26 California Less Than High School 4301513 25949 ## 27 California High School Graduate 5546711 33494 ## 28 California Some Colleges 7661164 41090 ## 29 California Bachelor Degree 5889724 65078 ## 30 California Advanced Degree 3538760 92334 ## 31 Colorado Total 3974943 46887 ## 32 Colorado Less Than High School 302220 30968 ## 33 Colorado High School Graduate 836590 35537 ## 34 Colorado Some Colleges 1140531 40819 ## 35 Colorado Bachelor Degree 1057825 58229 ## 36 Colorado Advanced Degree 637777 71616 ## 37 Connecticut Total 2496420 50788 ## 38 Connecticut Less Than High School 231839 24426 ## 39 Connecticut High School Graduate 668361 37017 ## 40 Connecticut Some Colleges 601672 42884 ## 41 Connecticut Bachelor Degree 549166 64143 ## 42 Connecticut Advanced Degree 445382 85175 ## 43 Delaware Total 687311 43164 ## 44 Delaware Less Than High School 66522 31024 ## 45 Delaware High School Graduate 207642 33671 ## 46 Delaware Some Colleges 184948 38048 ## 47 Delaware Bachelor Degree 134287 56603 ## 48 Delaware Advanced Degree 93912 70579 ## 49 District of Columbia Total 505145 71361 ## 50 District of Columbia Less Than High School 41168 30883 ## 51 District of Columbia High School Graduate 79881 31768 ## 52 District of Columbia Some Colleges 82667 44248 ## 53 District of Columbia Bachelor Degree 129825 75222 ## 54 District of Columbia Advanced Degree 171604 101956 ## 55 Florida Total 15484502 36021 ## 56 Florida Less Than High School 1794635 23292 ## 57 Florida High School Graduate 4396122 30064 ## 58 Florida Some Colleges 4540108 34752 ## 59 Florida Bachelor Degree 2982643 47810 ## 60 Florida Advanced Degree 1770994 62425 ## 61 Georgia Total 7080222 40312 ## 62 Georgia Less Than High School 856025 25479 ## 63 Georgia High School Graduate 1939945 31184 ## 64 Georgia Some Colleges 1982684 35846 ## 65 Georgia Bachelor Degree 1410395 53662 ## 66 Georgia Advanced Degree 891173 70027 ## 67 Hawaii Total 996668 44557 ## 68 Hawaii Less Than High School 75978 31620 ## 69 Hawaii High School Graduate 273421 35573 ## 70 Hawaii Some Colleges 312060 41842 ## 71 Hawaii Bachelor Degree 219979 52183 ## 72 Hawaii Advanced Degree 115230 72035 ## 73 Idaho Total 1170997 36445 ## 74 Idaho Less Than High School 99906 27667 ## 75 Idaho High School Graduate 305274 31395 ## 76 Idaho Some Colleges 429162 33984 ## 77 Idaho Bachelor Degree 220189 46364 ## 78 Idaho Advanced Degree 116466 60816 ## 79 Illinois Total 8694694 45015 ## 80 Illinois Less Than High School 882637 27186 ## 81 Illinois High School Graduate 2255611 32304 ## 82 Illinois Some Colleges 2447474 39400 ## 83 Illinois Bachelor Degree 1886240 60357 ## 84 Illinois Advanced Degree 1222732 76363 ## 85 Indiana Total 4502015 39833 ## 86 Indiana Less Than High School 468083 27765 ## 87 Indiana High School Graduate 1526825 32101 ## 88 Indiana Some Colleges 1294281 37154 ## 89 Indiana Bachelor Degree 777771 50630 ## 90 Indiana Advanced Degree 435055 65941 ## 91 Iowa Total 2123004 41268 ## 92 Iowa Less Than High School 156481 30381 ## 93 Iowa High School Graduate 658822 33066 ## 94 Iowa Some Colleges 685448 39073 ## 95 Iowa Bachelor Degree 420199 51751 ## 96 Iowa Advanced Degree 202054 66887 ## 97 Kansas Total 1918081 41181 ## 98 Kansas Less Than High School 157757 26549 ## 99 Kansas High School Graduate 504035 32106 ## 100 Kansas Some Colleges 603800 36994 ## 101 Kansas Bachelor Degree 414851 51678 ## 102 Kansas Advanced Degree 237638 62008 ## 103 Kentucky Total 3048442 37674 ## 104 Kentucky Less Than High School 390653 24631 ## 105 Kentucky High School Graduate 1012643 31313 ## 106 Kentucky Some Colleges 879223 35326 ## 107 Kentucky Bachelor Degree 453040 50711 ## 108 Kentucky Advanced Degree 312883 60270 ## 109 Louisiana Total 3140201 37599 ## 110 Louisiana Less Than High School 440844 22913 ## 111 Louisiana High School Graduate 1066026 30786 ## 112 Louisiana Some Colleges 849056 35064 ## 113 Louisiana Bachelor Degree 503947 50699 ## 114 Louisiana Advanced Degree 280328 60992 ## 115 Maine Total 991152 39550 ## 116 Maine Less Than High School 67314 25504 ## 117 Maine High School Graduate 311108 31798 ## 118 Maine Some Colleges 283731 36274 ## 119 Maine Bachelor Degree 205722 47375 ## 120 Maine Advanced Degree 123277 60347 ## 121 Maryland Total 4183858 52011 ## 122 Maryland Less Than High School 402152 30300 ## 123 Maryland High School Graduate 1030636 36700 ## 124 Maryland Some Colleges 1040840 44022 ## 125 Maryland Bachelor Degree 911781 65193 ## 126 Maryland Advanced Degree 798449 89066 ## 127 Massachusetts Total 4850576 52470 ## 128 Massachusetts Less Than High School 420941 30693 ## 129 Massachusetts High School Graduate 1158066 39463 ## 130 Massachusetts Some Colleges 1089826 42066 ## 131 Massachusetts Bachelor Degree 1197208 65373 ## 132 Massachusetts Advanced Degree 984535 85717 ## 133 Michigan Total 6894627 40450 ## 134 Michigan Less Than High School 596287 23192 ## 135 Michigan High School Graduate 2005981 31028 ## 136 Michigan Some Colleges 2221564 36272 ## 137 Michigan Bachelor Degree 1252685 54634 ## 138 Michigan Advanced Degree 818110 71623 ## 139 Minnesota Total 3847212 47050 ## 140 Minnesota Less Than High School 245690 28327 ## 141 Minnesota High School Graduate 939997 35337 ## 142 Minnesota Some Colleges 1228299 41858 ## 143 Minnesota Bachelor Degree 942830 60316 ## 144 Minnesota Advanced Degree 490396 75925 ## 145 Mississippi Total 1979664 32574 ## 146 Mississippi Less Than High School 290917 20764 ## 147 Mississippi High School Graduate 598609 27158 ## 148 Mississippi Some Colleges 648387 31459 ## 149 Mississippi Bachelor Degree 270712 44148 ## 150 Mississippi Advanced Degree 171039 56208 ## 151 Missouri Total 4206162 40078 ## 152 Missouri Less Than High School 391815 24831 ## 153 Missouri High School Graduate 1308859 31297 ## 154 Missouri Some Colleges 1234207 36127 ## 155 Missouri Bachelor Degree 775808 51217 ## 156 Missouri Advanced Degree 495473 63368 ## 157 Montana Total 741950 36953 ## 158 Montana Less Than High School 42682 27804 ## 159 Montana High School Graduate 211079 30843 ## 160 Montana Some Colleges 239041 33040 ## 161 Montana Bachelor Degree 171309 42150 ## 162 Montana Advanced Degree 77839 58287 ## 163 Nebraska Total 1271770 41488 ## 164 Nebraska Less Than High School 101272 30298 ## 165 Nebraska High School Graduate 326389 32174 ## 166 Nebraska Some Colleges 421522 38209 ## 167 Nebraska Bachelor Degree 277159 50779 ## 168 Nebraska Advanced Degree 145428 61853 ## 169 Nevada Total 2136466 39505 ## 170 Nevada Less Than High School 280915 29609 ## 171 Nevada High School Graduate 593417 32879 ## 172 Nevada Some Colleges 713215 40057 ## 173 Nevada Bachelor Degree 355837 50293 ## 174 Nevada Advanced Degree 193082 66105 ## 175 New Hampshire Total 979750 47392 ## 176 New Hampshire Less Than High School 65672 30119 ## 177 New Hampshire High School Graduate 275105 37820 ## 178 New Hampshire Some Colleges 270736 42368 ## 179 New Hampshire Bachelor Degree 224636 60544 ## 180 New Hampshire Advanced Degree 143601 71884 ## 181 New Jersey Total 6191229 51786 ## 182 New Jersey Less Than High School 599619 28427 ## 183 New Jersey High School Graduate 1666321 35048 ## 184 New Jersey Some Colleges 1373524 44983 ## 185 New Jersey Bachelor Degree 1555781 67038 ## 186 New Jersey Advanced Degree 995984 92098 ## 187 New Mexico Total 1425988 35284 ## 188 New Mexico Less Than High School 201328 21016 ## 189 New Mexico High School Graduate 376390 29002 ## 190 New Mexico Some Colleges 453672 32187 ## 191 New Mexico Bachelor Degree 221281 45109 ## 192 New Mexico Advanced Degree 173317 62501 ## 193 New York Total 13664734 47645 ## 194 New York Less Than High School 1694230 26036 ## 195 New York High School Graduate 3524192 33491 ## 196 New York Some Colleges 3280094 41421 ## 197 New York Bachelor Degree 2898440 62699 ## 198 New York Advanced Degree 2267778 81041 ## 199 North Carolina Total 7187077 38534 ## 200 North Carolina Less Than High School 818924 23976 ## 201 North Carolina High School Graduate 1839042 30369 ## 202 North Carolina Some Colleges 2207926 34861 ## 203 North Carolina Bachelor Degree 1471420 50977 ## 204 North Carolina Advanced Degree 849765 65620 ## 205 North Dakota Total 504375 43865 ## 206 North Dakota Less Than High School 33019 28756 ## 207 North Dakota High School Graduate 134432 34343 ## 208 North Dakota Some Colleges 183527 41818 ## 209 North Dakota Bachelor Degree 108527 51854 ## 210 North Dakota Advanced Degree 44870 61288 ## 211 Ohio Total 8049805 40586 ## 212 Ohio Less Than High School 740847 24836 ## 213 Ohio High School Graduate 2627758 31514 ## 214 Ohio Some Colleges 2324615 36821 ## 215 Ohio Bachelor Degree 1464945 53680 ## 216 Ohio Advanced Degree 891640 71180 ## 217 Oklahoma Total 2619244 38088 ## 218 Oklahoma Less Than High School 303266 24760 ## 219 Oklahoma High School Graduate 825284 31766 ## 220 Oklahoma Some Colleges 804185 35955 ## 221 Oklahoma Bachelor Degree 447888 47828 ## 222 Oklahoma Advanced Degree 238621 61092 ## 223 Oregon Total 2988118 40774 ## 224 Oregon Less Than High School 258399 27408 ## 225 Oregon High School Graduate 687243 31451 ## 226 Oregon Some Colleges 1010160 36817 ## 227 Oregon Bachelor Degree 627911 52498 ## 228 Oregon Advanced Degree 404405 70854 ## 229 Pennsylvania Total 9028036 42229 ## 230 Pennsylvania Less Than High School 811832 26343 ## 231 Pennsylvania High School Graduate 3103046 32567 ## 232 Pennsylvania Some Colleges 2195756 39075 ## 233 Pennsylvania Bachelor Degree 1761627 55326 ## 234 Pennsylvania Advanced Degree 1155775 73805 ## 235 Rhode Island Total 746952 46060 ## 236 Rhode Island Less Than High School 80207 31893 ## 237 Rhode Island High School Graduate 212282 36883 ## 238 Rhode Island Some Colleges 194188 40363 ## 239 Rhode Island Bachelor Degree 156087 57398 ## 240 Rhode Island Advanced Degree 104188 76827 ## 241 South Carolina Total 3563204 37727 ## 242 South Carolina Less Than High School 415678 23085 ## 243 South Carolina High School Graduate 1015260 30592 ## 244 South Carolina Some Colleges 1077707 35994 ## 245 South Carolina Bachelor Degree 656496 50734 ## 246 South Carolina Advanced Degree 398063 60788 ## 247 South Dakota Total 588029 38646 ## 248 South Dakota Less Than High School 46294 22131 ## 249 South Dakota High School Graduate 176644 31306 ## 250 South Dakota Some Colleges 190307 36732 ## 251 South Dakota Bachelor Degree 121231 47630 ## 252 South Dakota Advanced Degree 53553 57244 ## 253 Tennessee Total 4693962 37610 ## 254 Tennessee Less Than High School 562817 25365 ## 255 Tennessee High School Graduate 1480753 30596 ## 256 Tennessee Some Colleges 1302168 35518 ## 257 Tennessee Bachelor Degree 845100 50633 ## 258 Tennessee Advanced Degree 503124 62832 ## 259 Texas Total 18772550 40895 ## 260 Texas Less Than High School 2882388 25282 ## 261 Texas High School Graduate 4734422 31234 ## 262 Texas Some Colleges 5379207 38121 ## 263 Texas Bachelor Degree 3750797 56853 ## 264 Texas Advanced Degree 2025736 72195 ## 265 Utah Total 1911592 41679 ## 266 Utah Less Than High School 133060 28028 ## 267 Utah High School Graduate 442206 34667 ## 268 Utah Some Colleges 671665 37247 ## 269 Utah Bachelor Degree 448109 51611 ## 270 Utah Advanced Degree 216552 76099 ## 271 Vermont Total 445558 41496 ## 272 Vermont Less Than High School 30858 27052 ## 273 Vermont High School Graduate 129254 32425 ## 274 Vermont Some Colleges 113174 39882 ## 275 Vermont Bachelor Degree 101015 47170 ## 276 Vermont Advanced Degree 71257 61617 ## 277 Virginia Total 5872757 46873 ## 278 Virginia Less Than High School 584712 23892 ## 279 Virginia High School Graduate 1387610 32366 ## 280 Virginia Some Colleges 1575365 40071 ## 281 Virginia Bachelor Degree 1312800 61529 ## 282 Virginia Advanced Degree 1012270 85582 ## 283 Washington Total 5290324 48567 ## 284 Washington Less Than High School 440074 30627 ## 285 Washington High School Graduate 1167347 36441 ## 286 Washington Some Colleges 1727271 42030 ## 287 Washington Bachelor Degree 1204728 62447 ## 288 Washington Advanced Degree 750904 86167 ## 289 West Virginia Total 1281086 35440 ## 290 West Virginia Less Than High School 164805 20200 ## 291 West Virginia High School Graduate 515431 30573 ## 292 West Virginia Some Colleges 331144 32380 ## 293 West Virginia Bachelor Degree 161686 45304 ## 294 West Virginia Advanced Degree 108020 58802 ## 295 Wisconsin Total 4015285 42222 ## 296 Wisconsin Less Than High School 290862 29561 ## 297 Wisconsin High School Graduate 1223392 33547 ## 298 Wisconsin Some Colleges 1242652 40482 ## 299 Wisconsin Bachelor Degree 829878 52425 ## 300 Wisconsin Advanced Degree 428501 67112 ## 301 Wyoming Total 389847 40800 ## 302 Wyoming Less Than High School 21250 29982 ## 303 Wyoming High School Graduate 117501 36929 ## 304 Wyoming Some Colleges 137539 36885 ## 305 Wyoming Bachelor Degree 73183 47962 ## 306 Wyoming Advanced Degree 40374 61288 ## 307 Puerto Rico Total 2301735 18587 ## 308 Puerto Rico Less Than High School 488408 11259 ## 309 Puerto Rico High School Graduate 648146 15055 ## 310 Puerto Rico Some Colleges 538601 17187 ## 311 Puerto Rico Bachelor Degree 443589 24668 ## 312 Puerto Rico Advanced Degree 182991 34649 birth &lt;- read.csv(&quot;./data/births.csv&quot;, na.strings = &quot;N/A&quot;) birth &lt;- birth %&gt;% pivot_longer(cols =1:20 ,names_to = c(&quot;Give_birth&quot;,&quot;Marriage&quot;,&quot;Education&quot;), names_sep = &quot;_&quot;, values_to = &quot;Estimate&quot;) # Make character values more descriptive and succinct as possible # Need a note about the inclusion of each group specifically: # For example, high school = high school (including equivalency), advanced degree = graduate or professional degree birth &lt;- abbreviate(birth) birth ## # A tibble: 20 x 4 ## Give_birth Marriage Education Estimate ## &lt;chr&gt; &lt;chr&gt; &lt;fct&gt; &lt;int&gt; ## 1 Birth Married Less Than High School 202572 ## 2 Birth Married High School Graduate 448750 ## 3 Birth Married Some Colleges 715554 ## 4 Birth Married Bachelor Degree 745148 ## 5 Birth Married Advanced Degree 494817 ## 6 Birth Unmarried Less Than High School 220616 ## 7 Birth Unmarried High School Graduate 450356 ## 8 Birth Unmarried Some Colleges 460590 ## 9 Birth Unmarried Bachelor Degree 103445 ## 10 Birth Unmarried Advanced Degree 36034 ## 11 NoBirth Married Less Than High School 2686948 ## 12 NoBirth Married High School Graduate 5906857 ## 13 NoBirth Married Some Colleges 8802059 ## 14 NoBirth Married Bachelor Degree 7961510 ## 15 NoBirth Married Advanced Degree 5241343 ## 16 NoBirth Unmarried Less Than High School 9244270 ## 17 NoBirth Unmarried High School Graduate 9252305 ## 18 NoBirth Unmarried Some Colleges 13748688 ## 19 NoBirth Unmarried Bachelor Degree 7213809 ## 20 NoBirth Unmarried Advanced Degree 2943900 # Function of combining some races into &#39;Other Races&#39; category combine_races &lt;- function(race, combine_list){ race[race$Race %in% combine_list, &quot;Race&quot;] &lt;- &quot;Other&quot; combine_race &lt;- race %&gt;% filter(Race == &quot;Other&quot;) %&gt;% group_by(Gender, Education) %&gt;% summarise(Estimate = sum(Estimate), .groups = &quot;drop&quot;) %&gt;% mutate(Race = &quot;Other&quot;) race &lt;- race[!race$Race == &quot;Other&quot;, ] race &lt;- rbind(race, combine_race) return(race) } race &lt;- read.csv(&quot;./data/race.csv&quot;, na.strings = &quot;N/A&quot;) race&lt;- race %&gt;% pivot_longer(cols = !Gender ,names_to = c(&quot;Race&quot;,&quot;Education&quot;), names_sep = &quot;_&quot;, values_to = &quot;Estimate&quot;) other_race_list = list(&quot;Native.Hawaiian.and.Other.Pacific.Islander.alone&quot;, &quot;American.Indian.or.Alaska.Native.alone&quot;, &quot;Some.other.race.alone&quot;, &quot;Two.or.more.races&quot;) race &lt;- combine_races(race, other_race_list) # Make character values more descriptive and succinct as possible # Need a note that: white means white alone does not count Hispanic or Latino # Other races include: xxx race &lt;- abbreviate(race, race = TRUE,) ## Warning: Unknown levels in `f`: &gt;= Bachelor Degree or Higher race ## # A tibble: 45 x 4 ## Gender Race Education Estimate ## &lt;chr&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; ## 1 Total White Alone Total 144203068 ## 2 Total White Alone High School or Higher 134556337 ## 3 Total White Alone Bachelor Degree or Higher 53161917 ## 4 Total Hispanic or Latino Origin Total 34949077 ## 5 Total Hispanic or Latino Origin High School or Higher 24623646 ## 6 Total Hispanic or Latino Origin Bachelor Degree or Higher 6164098 ## 7 Total Black Alone Total 27336967 ## 8 Total Black Alone High School or Higher 23799881 ## 9 Total Black Alone Bachelor Degree or Higher 6164066 ## 10 Total Asian Alone Total 13381406 ## # … with 35 more rows education &lt;- read.csv(&quot;./data/2015-2019Education.csv&quot;, na.strings = &quot;N/A&quot;) education&lt;-education %&gt;% pivot_longer(cols = !Gender ,names_to = c(&quot;Year&quot;,&quot;Education&quot;), names_sep = &quot;_&quot;, values_to = &quot;Estimate&quot;) education$Year &lt;- as.integer(gsub(&quot;X&quot;, &quot;&quot;, education$Year)) # Make character values more descriptive and succinct as possible education &lt;- abbreviate(education) education ## # A tibble: 50 x 4 ## Gender Year Education Estimate ## &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt; ## 1 Males 2015 Less Than High School 14181016 ## 2 Males 2015 High School Graduate 29620517 ## 3 Males 2015 Some Colleges 29027333 ## 4 Males 2015 Bachelor Degree 19615278 ## 5 Males 2015 Advanced Degree 12033250 ## 6 Males 2016 Less Than High School 14016654 ## 7 Males 2016 High School Graduate 29600138 ## 8 Males 2016 Some Colleges 29340080 ## 9 Males 2016 Bachelor Degree 20030807 ## 10 Males 2016 Advanced Degree 12478805 ## # … with 40 more rows earning &lt;- read.csv(&quot;./data/2015-2019earnings.csv&quot;, na.strings = &quot;N/A&quot;) earning&lt;-earning %&gt;% pivot_longer(cols = !Gender ,names_to = c(&quot;Year&quot;,&quot;Education&quot;), names_sep = &quot;_&quot;, values_to = &quot;Earning&quot;) earning$Year &lt;- as.integer(gsub(&quot;X&quot;, &quot;&quot;, earning$Year)) earning &lt;- abbreviate(earning,total=TRUE) earning ## # A tibble: 90 x 4 ## Gender Year Education Earning ## &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt; ## 1 Total 2015 Total 36860 ## 2 Total 2015 Less Than High School 21320 ## 3 Total 2015 High School Graduate 29004 ## 4 Total 2015 Some Colleges 34377 ## 5 Total 2015 Bachelor Degree 50930 ## 6 Total 2015 Advanced Degree 67286 ## 7 Total 2016 Total 37842 ## 8 Total 2016 Less Than High School 21839 ## 9 Total 2016 High School Graduate 29969 ## 10 Total 2016 Some Colleges 35406 ## # … with 80 more rows "],["missing-values.html", "Chapter 4 Missing values", " Chapter 4 Missing values "],["results.html", "Chapter 5 Results", " Chapter 5 Results library(ggplot2) library(gridExtra) ## ## Attaching package: &#39;gridExtra&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## combine library(vcd) ## Loading required package: grid library(ggmosaic) ## ## Attaching package: &#39;ggmosaic&#39; ## The following objects are masked from &#39;package:vcd&#39;: ## ## mosaic, spine library(usdata) edu2019&lt;- education[education$Year==2019,] edu2019%&gt;% group_by(Gender)%&gt;% mutate(total_pop = sum(Estimate))%&gt;% ungroup()%&gt;% ggplot()+ geom_col(aes(x = Education,y=Estimate/total_pop, fill = Gender), position=&quot;dodge&quot; )+ xlab(&quot;Year in School&quot;) + ylab(&quot;Proportion&quot;)+ ggtitle(&quot;Grouped Bar Chart of Education Attainment in 2019 Differed by Gender&quot;) #mosaic plot!!! #x education y gender #科学计数法 race_total &lt;- race[race$Gender==&quot;Total&quot;,] ggplot(race_total)+ geom_col(aes(x=Race,y=Estimate,fill=Education),position =&quot;dodge&quot;)+ xlab(&quot;Race&quot;)+ ylab(&quot;Population&quot;)+ ggtitle(&quot;Group Bar Chart of 2019 Education Attainment by Race&quot;)+ theme(axis.text.x = element_text(angle=20, vjust=0.5)) race_gender &lt;- race[race$Gender !=&quot;Total&quot;,] #mosaic plot: x = race, y = gender, facet by education race_gender &lt;- race_gender[race_gender$Education != &quot;Total&quot;,] race_gender ## # A tibble: 20 x 4 ## Gender Race Education Estimate ## &lt;chr&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; ## 1 Males White Alone High School or Higher 65002939 ## 2 Males White Alone Bachelor Degree or Higher 25550556 ## 3 Males Hispanic or Latino Origin High School or Higher 12088356 ## 4 Males Hispanic or Latino Origin Bachelor Degree or Higher 2791429 ## 5 Males Black Alone High School or Higher 10831809 ## 6 Males Black Alone Bachelor Degree or Higher 2481765 ## 7 Males Asian Alone High School or Higher 5515960 ## 8 Males Asian Alone Bachelor Degree or Higher 3553501 ## 9 Females White Alone High School or Higher 69553398 ## 10 Females White Alone Bachelor Degree or Higher 27611361 ## 11 Females Hispanic or Latino Origin High School or Higher 12535290 ## 12 Females Hispanic or Latino Origin Bachelor Degree or Higher 3372669 ## 13 Females Black Alone High School or Higher 12968072 ## 14 Females Black Alone Bachelor Degree or Higher 3682301 ## 15 Females Asian Alone High School or Higher 6231119 ## 16 Females Asian Alone Bachelor Degree or Higher 3881347 ## 17 Females Other Bachelor Degree or Higher 1795566 ## 18 Females Other High School or Higher 6324225 ## 19 Males Other Bachelor Degree or Higher 1492932 ## 20 Males Other High School or Higher 6134805 #男女比例 #check value ggplot(race_gender) + geom_col(aes(x = fct_rev(Race),y=Estimate, fill = Gender), position = &quot;fill&quot;) + xlab(&quot;Race&quot;) + theme(legend.position = &quot;bottom&quot;) + coord_flip()+ guides(fill = guide_legend(reverse = TRUE)) + facet_wrap(~Education, ncol = 1) + ylab(&quot;proportion&quot;) + ggtitle(&quot;Proportional breakdown of Gender for each race, faceted on Education Attainment&quot;) #add legend！！！ earning2019 &lt;- earning[earning$Year==2019,] earning_total&lt;- earning2019$Earning[earning2019$Education==&quot;Total&quot;] earning2019 &lt;- earning2019[earning2019$Education!= &quot;Total&quot;,] earning2019%&gt;% group_by(Education)%&gt;% mutate(total_earn =earning_total )%&gt;% ungroup()%&gt;% ggplot()+ geom_col(aes(x=Education,y=Earning))+ geom_hline(aes(yintercept=total_earn),col=&quot;red&quot;)+ coord_flip()+ facet_wrap(~Gender, ncol = 1) + ggtitle(&quot;Median Earning in 2019 based on Education Attainment and Gender&quot;) #earning_plot + facet_grid(rows = vars(Gender)) #change birth csv file #title #check value ggplot(birth) + geom_col(aes(x = as.factor(Marriage), y = Estimate, fill = fct_rev(Education)), position = &quot;fill&quot;)+ coord_flip() + theme_light(15)+ theme(legend.position = &quot;bottom&quot;) + guides(fill = guide_legend(reverse = TRUE)) + scale_fill_discrete(name = &quot;Education&quot;)+ theme(legend.title = element_text(size = 7),legend.text = element_text(size=7))+ facet_wrap(~Give_birth, ncol = 1)+ ylab(&quot;proportion&quot;) + xlab(&quot;Marriage Status&quot;)+ ggtitle(&quot;2019 Proportional breakdown of education attainment on \\n marriage status,faceted on giving birth or not&quot;) #one title #y label too small new_states&lt;-states %&gt;% group_by(State)%&gt;% mutate(bachelor_higher = (Population[Education==&quot;Bachelor Degree&quot;]+Population[Education==&quot;Advanced Degree&quot;])/Population[Education == &quot;Total&quot;])%&gt;% mutate(abb = state2abbr(State))%&gt;% mutate(median_earning = Earning[Education==&quot;Total&quot;])%&gt;% ungroup() new_states$abb[is.na(new_states$abb)]=&quot;PR&quot; ba_rate&lt;-ggplot(new_states)+ geom_point(aes(x=bachelor_higher, y=reorder(abb, bachelor_higher)), color = &quot;blue&quot;) + xlab(&quot;Rate of Bachelor Degree or Higher&quot;)+ ylab(&quot;State&quot;)+ ggtitle(&quot;2019 Rate of Bachelor Degree or Higher for Each State&quot;)+ theme_light() earnings &lt;- ggplot(new_states)+ geom_point(aes(x=median_earning, y=reorder(abb,bachelor_higher)), color = &quot;red&quot;) + xlab(&quot;Median Earning of the State&quot;)+ ylab(&quot;State&quot;)+ ggtitle(&quot;2019 Median Earning for Each State&quot;)+ theme_light() grid.arrange(ba_rate, earnings, ncol=2) "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclustion.html", "Chapter 7 Conclustion", " Chapter 7 Conclustion "]]
